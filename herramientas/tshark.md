# T-SHARK

En caso de tener una captura de trafico .pcap o .pcapng puedes examinar el contenido con wireshark o hacer uso de t-shark. 

Ademas podemos capturar trafico al igual que herramientas como tcpdump o wireshark.

## Captura de tráfico

Listar interfaces:

```
tshark -D
```

Una vez hayamos elegido la interfaz con la que queremos capturar:

```
ping 192.168.0.12

tshark -i <interfaz>
```

podemos capturar solo unb numero especifico de paquetes:

```
tshark -i eth0 -c 10

-c = indica la cantidad de paquetes a capturar
```

exportar lo capturado:

```
tshark -i eth0 -c 10 -w captura.pcap

-w = para exportar
```

## Lectura de paquetes capturados

Importar una captura .pcap:

```
tshark -r captura.pcap

# modo mas detallado (verbose)

tshark -r captura.pcap -V
```

Podemos indicarle un formato de salida para que se muestrer mejor la captura:

```
tshark -r captura.pcap -T <formato>

```

se tiene los siguientes formatos:

* pdml:  Packet Details Mark-Up Language, que se basa en XML.
* ps: PostScript. Esta salida está en forma de resumen de una línea de cada paquete de datos
* psml: Packet Summary Mark-Up Language También es un formato basado en XML como PDML que resume la información detallada de los paquetes.
* json: muestro en el formato json.
* ek: Es una función de formato JSON delimitado por saltos de línea para la importación masiva en la opción de búsqueda elástica.
* text: El texto es un resumen de una línea legible por humanos de cada uno de los paquetes.
* tabs: Esta opción es bastante similar al texto excepto que incluye un carácter de tabulación horizontal ASCII como delimitador entre cada columna.

Puedes agregar un **2>/dev/null** al final de cada comando para eliminar los warnings que muestran.

Se puede hacer un grep para ver lo que nos interesa o tambien hay la opcion de filtrado como en wiershark

```
tshark -i eth0 -c 5 -f "tcp port 80" -Y 'http.request.method == "GET"'

-f = de un puerto en particular
-Y = cualquier tipo de filtro de wireshark
```