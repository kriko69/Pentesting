# SMBClient

Es un sistema de archivos compartidos que trabaja para windows y linux

### usuario anonimo

```
smbclient -L //192.168.0.1
```

* -L: Esta opción le permite ver qué servicios están disponibles en un servidor.
* 192.168.0.1 es la ip del servidor samba

si tiene acceso anonimo no es necesario especificar el usuario  contraseña.

### usuario especifico

```
smbclient -L //192.168.0.1 -U usuario
```

Pedira la contraseña del usuario 

### conectarnos a un recurso compartido

Se debe quitar la opcion -L y se tiene que aumentar el nombre de la carpeta un el host. Supongamos que la carpeta se llama claves$. Esta carpeta lo ves con la opcion -L.

```
smbclient //192.168.0.1/claves$ -U usuario
```

se pone la contraseña de usuario y te abre la consola.

```
smb: \>
```

**opciones**

* help: ayuda
* ls: listar archivos
* cd: entrar a un directorio
* pwd: ver path actual
* more: ver cntenido del archivo

admite la mayoria de los comandos linux

### upload y download

**descargar un archivo**

```
get nombre_archivo.extension
```

para ver donde se descargo se usa el comando lcd

* lcd: local cd

```
lcd
```

va a listar el contenido de la carpeta por defecto en este caso /root pero de la maquina local.

si quiero descargar un archivo de mi directorio local /Desktop realizo lo siguiente

```
lcd /home/kali/Desktop  --> nos colocamoos en la ruta de la maquina local /home/kali/Desktop
lcd  --> vemos que hay en la ruta local
dir  --> listamos los archivos de la ruta del servidor
get archivo.sh  --> descargamos el archivo.sh en la ruta /home/kali/Desktop
```

**subida de archivos**

```
lcd /home/kali/Documents/tools  --> vamos al directorio donde eta el archivo que queremos subir
lcd  --> listamos para ver si esta el archivo
put malware.py  --> subimos el archivo al directorio del servidor
```

## SMBMAP

SMBMap permite a los usuarios enumerar las unidades compartidas de samba en todo un dominio. Enumere las unidades compartidas, los permisos de las unidades, los contenidos compartidos

```
smbmap -u usuario -p password -H 192.168.0.1
```

la opcion -p de password tambien admite un hash para usar como pass-th-hash

## listar las versiones de SMB con NMAP

primero veremos los scripts de nmap para smb

```
ls /usr/share/nmap/script/smb*
```

para usar uno de la lista con nmap

```
nmap --script="smb-script" ...
```


* [https://tools.kali.org/information-gathering/smbmap](https://tools.kali.org/information-gathering/smbmap)








