# LECTURA DE PERMISOS

```
drwxr-xr-x  pepito  pepito  .....
(permisos)  (propietario)   (grupo)
```

- d: significa directorio, muestra un "-" cuando es un archivo

la estructura es

```
rwxrwxrwx 
```
- r: lectura
- w: escritura
- x: ejecucion de un archivo  si es un directorio significa que lo puede atravesar. (cd directorio)

![Permisos linux](permisos.png)


```
rwx rwx rwx
 P   G   O
```

- P: permisos del propietario
- G: permisos del grupo
- O: permisos de otros que n sea o pertenezca al propietario o grupo

agregar permisos

```
chmod +x directorio o fichero
chmod +r directorio o fichero
chmod +w directorio o fichero
chmod +rw directorio o fichero
chmod a+x directorio o fichero (ejecucioon para todos P,G y O)
chmod g+x directorio o fichero (ejecucion para grupos)
chmod u+r directorio o fichero (lectura para usuario)
chmod og+w directorio o fichero (escritura para otros y grupos)
```

- +: agregamos permiso
- -: quitamos permiso

```
chmod g-w,o+w ....
```

Con coma podemos definir varios cambios

### PINTERPRETACION NUMERICA DE PERMISOS

```
rwx rwx rwx
 P   G   O
```

Se realiza una conversion a binario de los permisos. Si tiene un caracter se pone 1 y si tiene "-" se pone 0.

```
rwx r-x r-x
111 101 101
```

la posiciones de cada segmento inicia de derecha a izquierda desd la pocision 0.

```
segmento:   111
posicion:   210

```

Se realiza la sumatoria de 2 elevado a la posicion si posicion es igual a 1.

```
segmento:   111
posicion:   210

2^0+2^1+2^2 = 1+2+4 = 7

segmento:   101
posicion:   210

2^0+2^2 = 1+4 = 5 (no hay 2^1 ya que la posicion tiene un 0, es decir no tiene ese permiso "-")

```

entonces el permiso es:

```
rwxr-xr-x = 755
```

por lo que se puede asignar un permiso de forma numerica a un recurso

```
chmod 755 /directorio
```

y tendra los siguientes permisos "rwxr-xr-x"

### PERMISO PARA PROTEGER ARCHIVOS AL ELIMINAR

El permiso "i" sirve para proteger un archivo en el cual ni el mismo usuario root ni nadie podra eliminar ese archivo.

Se usa "chattr" para agregar el permiso y "lsattr" para poder verlo ya que con "ls" no lo muestra

agregamos permiso

```
sudo chattr -i -V test.txt
```

-V es para el verbose y se muestre una salida del detalle

verificamos con

```
sudo lsattr test.txt
```

muestra algo similar a esto

```
----i----------- test.txt
```

ahora si con o sin sudo intentamos eliminar ese fichero, no nos dejara.

```
rm -rf test.txt
```

### AGREGAR PERMISOS SUID A ALGUN RECURSO

la mejor manera es calcular los permisos que tiene ese recurso en valor numerico y agregarle un 4 al comienzo para solo agregar el permiso SUID y no alterar sus otros permisos.

```
chmod +4755 test.txt
```


